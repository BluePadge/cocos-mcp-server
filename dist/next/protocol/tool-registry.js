"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.NextToolRegistry = void 0;
class NextToolRegistry {
    constructor(tools, matrix) {
        this.tools = tools;
        this.matrix = matrix;
    }
    listTools() {
        return this.tools
            .filter((tool) => this.isToolAvailable(tool))
            .map((tool) => ({
            name: tool.name,
            description: tool.description,
            inputSchema: tool.inputSchema,
            _meta: {
                layer: tool.layer,
                category: tool.category,
                safety: this.getSafety(tool),
                idempotent: this.isIdempotent(tool),
                supportsDryRun: false
            }
        }));
    }
    getTool(name) {
        const tool = this.tools.find((item) => item.name === name);
        if (!tool) {
            return null;
        }
        return this.isToolAvailable(tool) ? tool : null;
    }
    getManifest(name) {
        const tool = this.tools.find((item) => item.name === name);
        if (!tool) {
            return null;
        }
        return {
            name: tool.name,
            description: tool.description,
            inputSchema: tool.inputSchema,
            outputSchema: {
                type: 'object',
                properties: {
                    success: { type: 'boolean' },
                    data: { type: ['object', 'array', 'string', 'number', 'boolean', 'null'] },
                    error: {
                        type: 'object',
                        properties: {
                            code: { type: 'string' },
                            message: { type: 'string' },
                            detail: { type: 'string' }
                        }
                    }
                },
                required: ['success']
            },
            requiredCapabilities: [...tool.requiredCapabilities],
            _meta: {
                layer: tool.layer,
                category: tool.category,
                idempotent: this.isIdempotent(tool),
                safety: this.getSafety(tool),
                supportsDryRun: false
            }
        };
    }
    getCapabilityMatrix() {
        return this.matrix;
    }
    isToolAvailable(tool) {
        return tool.requiredCapabilities.every((key) => { var _a; return ((_a = this.matrix.byKey[key]) === null || _a === void 0 ? void 0 : _a.available) === true; });
    }
    isIdempotent(tool) {
        const writeKeywords = this.getWriteKeywords();
        return !this.hasActionKeyword(tool.name, writeKeywords);
    }
    getSafety(tool) {
        if (this.hasActionKeyword(tool.name, ['delete', 'remove'])) {
            return 'destructive';
        }
        if (this.hasActionKeyword(tool.name, this.getWriteKeywords())) {
            return 'cautious';
        }
        return 'safe';
    }
    getWriteKeywords() {
        return [
            'create',
            'delete',
            'remove',
            'copy',
            'move',
            'set',
            'change',
            'execute',
            'reload',
            'snapshot',
            'open',
            'save',
            'close',
            'add',
            'duplicate',
            'parent',
            'focus',
            'align',
            'restore',
            'reset',
            'apply'
        ];
    }
    hasActionKeyword(toolName, keywords) {
        const tokens = toolName.split('_').filter((token) => token !== '');
        return keywords.some((keyword) => tokens.includes(keyword));
    }
}
exports.NextToolRegistry = NextToolRegistry;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9vbC1yZWdpc3RyeS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NvdXJjZS9uZXh0L3Byb3RvY29sL3Rvb2wtcmVnaXN0cnkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBaUJBLE1BQWEsZ0JBQWdCO0lBSXpCLFlBQVksS0FBMkIsRUFBRSxNQUF3QjtRQUM3RCxJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztRQUNuQixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztJQUN6QixDQUFDO0lBRU0sU0FBUztRQUNaLE9BQU8sSUFBSSxDQUFDLEtBQUs7YUFDWixNQUFNLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDNUMsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ1osSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJO1lBQ2YsV0FBVyxFQUFFLElBQUksQ0FBQyxXQUFXO1lBQzdCLFdBQVcsRUFBRSxJQUFJLENBQUMsV0FBVztZQUM3QixLQUFLLEVBQUU7Z0JBQ0gsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLO2dCQUNqQixRQUFRLEVBQUUsSUFBSSxDQUFDLFFBQVE7Z0JBQ3ZCLE1BQU0sRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQztnQkFDNUIsVUFBVSxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDO2dCQUNuQyxjQUFjLEVBQUUsS0FBSzthQUN4QjtTQUNKLENBQUMsQ0FBQyxDQUFDO0lBQ1osQ0FBQztJQUVNLE9BQU8sQ0FBQyxJQUFZO1FBQ3ZCLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxDQUFDO1FBQzNELElBQUksQ0FBQyxJQUFJ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QUM7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDO0lBRU8sZ0JBQWdCO1FBQ3BCLE9BQU87WUFDSCxRQUFRO1lBQ1IsUUFBUTtZQUNSLFFBQVE7WUFDUixNQUFNO1lBQ04sTUFBTTtZQUNOLEtBQUs7WUFDTCxRQUFRO1lBQ1IsU0FBUztZQUNULFFBQVE7WUFDUixVQUFVO1lBQ1YsTUFBTTtZQUNOLE1BQU07WUFDTixPQUFPO1lBQ1AsS0FBSztZQUNMLFdBQVc7WUFDWCxRQUFRO1lBQ1IsT0FBTztZQUNQLE9BQU87WUFDUCxTQUFTO1lBQ1QsT0FBTztZQUNQLE9BQU87U0FDVixDQUFDO0lBQ04sQ0FBQztJQUVPLGdCQUFnQixDQUFDLFFBQWdCLEVBQUUsUUFBa0I7UUFDekQsTUFBTSxNQUFNLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLEtBQUssS0FBSyxFQUFFLENBQUMsQ0FBQztRQUNuRSxPQUFPLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztJQUNoRSxDQUFDO0NBQ0o7QUE1SEQsNENBNEhDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2FwYWJpbGl0eU1hdHJpeCwgTmV4dFRvb2xEZWZpbml0aW9uIH0gZnJvbSAnLi4vbW9kZWxzJztcblxuZXhwb3J0IGludGVyZmFjZSBUb29sTWFuaWZlc3Qge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIGlucHV0U2NoZW1hOiBhbnk7XG4gICAgb3V0cHV0U2NoZW1hOiBhbnk7XG4gICAgcmVxdWlyZWRDYXBhYmlsaXRpZXM6IHN0cmluZ1tdO1xuICAgIF9tZXRhOiB7XG4gICAgICAgIGxheWVyOiBzdHJpbmc7XG4gICAgICAgIGNhdGVnb3J5OiBzdHJpbmc7XG4gICAgICAgIGlkZW1wb3RlbnQ6IGJvb2xlYW47XG4gICAgICAgIHNhZmV0eTogJ3NhZmUnIHwgJ2NhdXRpb3VzJyB8ICdkZXN0cnVjdGl2ZSc7XG4gICAgICAgIHN1cHBvcnRzRHJ5UnVuOiBib29sZWFuO1xuICAgIH07XG59XG5cbmV4cG9ydCBjbGFzcyBOZXh0VG9vbFJlZ2lzdHJ5IHtcbiAgICBwcml2YXRlIHJlYWRvbmx5IHRvb2xzOiBOZXh0VG9vbERlZmluaXRpb25bXTtcbiAgICBwcml2YXRlIHJlYWRvbmx5IG1hdHJpeDogQ2FwYWJpbGl0eU1hdHJpeDtcblxuICAgIGNvbnN0cnVjdG9yKHRvb2xzOiBOZXh0VG9vbERlZmluaXRpb25bXSwgbWF0cml4OiBDYXBhYmlsaXR5TWF0cml4KSB7XG4gICAgICAgIHRoaXMudG9vbHMgPSB0b29scztcbiAgICAgICAgdGhpcy5tYXRyaXggPSBtYXRyaXg7XG4gICAgfVxuXG4gICAgcHVibGljIGxpc3RUb29scygpOiBBcnJheTx7IG5hbWU6IHN0cmluZzsgZGVzY3JpcHRpb246IHN0cmluZzsgaW5wdXRTY2hlbWE6IGFueTsgX21ldGE6IGFueSB9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLnRvb2xzXG4gICAgICAgICAgICAuZmlsdGVyKCh0b29sKSA9PiB0aGlzLmlzVG9vbEF2YWlsYWJsZSh0b29sKSlcbiAgICAgICAgICAgIC5tYXAoKHRvb2wpID0+ICh7XG4gICAgICAgICAgICAgICAgbmFtZTogdG9vbC5uYW1lLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0b29sLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgIGlucHV0U2NoZW1hOiB0b29sLmlucHV0U2NoZW1hLFxuICAgICAgICAgICAgICAgIF9tZXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGxheWVyOiB0b29sLmxheWVyLFxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogdG9vbC5jYXRlZ29yeSxcbiAgICAgICAgICAgICAgICAgICAgc2FmZXR5OiB0aGlzLmdldFNhZmV0eSh0b29sKSxcbiAgICAgICAgICAgICAgICAgICAgaWRlbXBvdGVudDogdGhpcy5pc0lkZW1wb3RlbnQodG9vbCksXG4gICAgICAgICAgICAgICAgICAgIHN1cHBvcnRzRHJ5UnVuOiBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0VG9vbChuYW1lOiBzdHJpbmcpOiBOZXh0VG9vbERlZmluaXRpb24gfCBudWxsIHtcbiAgICAgICAgY29uc3QgdG9vbCA9IHRoaXMudG9vbHMuZmluZCgoaXRlbSkgPT4gaXRlbS5uYW1lID09PSBuYW1lKTtcbiAgICAgICAgaWYgKCF0b29sKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5pc1Rvb2xBdmFpbGFibGUodG9vbCkgPyB0b29sIDogbnVsbDtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0TWFuaWZlc3QobmFtZTogc3RyaW5nKTogVG9vbE1hbmlmZXN0IHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IHRvb2wgPSB0aGlzLnRvb2xzLmZpbmQoKGl0ZW0pID0+IGl0ZW0ubmFtZSA9PT0gbmFtZSk7XG4gICAgICAgIGlmICghdG9vbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogdG9vbC5uYW1lLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHRvb2wuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICBpbnB1dFNjaGVtYTogdG9vbC5pbnB1dFNjaGVtYSxcbiAgICAgICAgICAgIG91dHB1dFNjaGVtYToge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogeyB0eXBlOiAnYm9vbGVhbicgfSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyB0eXBlOiBbJ29iamVjdCcsICdhcnJheScsICdzdHJpbmcnLCAnbnVtYmVyJywgJ2Jvb2xlYW4nLCAnbnVsbCddIH0sXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogeyB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbDogeyB0eXBlOiAnc3RyaW5nJyB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbJ3N1Y2Nlc3MnXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlcXVpcmVkQ2FwYWJpbGl0aWVzOiBbLi4udG9vbC5yZXF1aXJlZENhcGFiaWxpdGllc10sXG4gICAgICAgICAgICBfbWV0YToge1xuICAgICAgICAgICAgICAgIGxheWVyOiB0b29sLmxheWVyLFxuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiB0b29sLmNhdGVnb3J5LFxuICAgICAgICAgICAgICAgIGlkZW1wb3RlbnQ6IHRoaXMuaXNJZGVtcG90ZW50KHRvb2wpLFxuICAgICAgICAgICAgICAgIHNhZmV0eTogdGhpcy5nZXRTYWZldHkodG9vbCksXG4gICAgICAgICAgICAgICAgc3VwcG9ydHNEcnlSdW46IGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHVibGljIGdldENhcGFiaWxpdHlNYXRyaXgoKTogQ2FwYWJpbGl0eU1hdHJpeCB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hdHJpeDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGlzVG9vbEF2YWlsYWJsZSh0b29sOiBOZXh0VG9vbERlZmluaXRpb24pOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRvb2wucmVxdWlyZWRDYXBhYmlsaXRpZXMuZXZlcnkoKGtleSkgPT4gdGhpcy5tYXRyaXguYnlLZXlba2V5XT8uYXZhaWxhYmxlID09PSB0cnVlKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGlzSWRlbXBvdGVudCh0b29sOiBOZXh0VG9vbERlZmluaXRpb24pOiBib29sZWFuIHtcbiAgICAgICAgY29uc3Qgd3JpdGVLZXl3b3JkcyA9IHRoaXMuZ2V0V3JpdGVLZXl3b3JkcygpO1xuICAgICAgICByZXR1cm4gIXRoaXMuaGFzQWN0aW9uS2V5d29yZCh0b29sLm5hbWUsIHdyaXRlS2V5d29yZHMpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0U2FmZXR5KHRvb2w6IE5leHRUb29sRGVmaW5pdGlvbik6ICdzYWZlJyB8ICdjYXV0aW91cycgfCAnZGVzdHJ1Y3RpdmUnIHtcbiAgICAgICAgaWYgKHRoaXMuaGFzQWN0aW9uS2V5d29yZCh0b29sLm5hbWUsIFsnZGVsZXRlJywgJ3JlbW92ZSddKSkge1xuICAgICAgICAgICAgcmV0dXJuICdkZXN0cnVjdGl2ZSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaGFzQWN0aW9uS2V5d29yZCh0b29sLm5hbWUsIHRoaXMuZ2V0V3JpdGVLZXl3b3JkcygpKSkge1xuICAgICAgICAgICAgcmV0dXJuICdjYXV0aW91cyc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICdzYWZlJztcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldFdyaXRlS2V5d29yZHMoKTogc3RyaW5nW10ge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgJ2NyZWF0ZScsXG4gICAgICAgICAgICAnZGVsZXRlJyxcbiAgICAgICAgICAgICdyZW1vdmUnLFxuICAgICAgICAgICAgJ2NvcHknLFxuICAgICAgICAgICAgJ21vdmUnLFxuICAgICAgICAgICAgJ3NldCcsXG4gICAgICAgICAgICAnY2hhbmdlJyxcbiAgICAgICAgICAgICdleGVjdXRlJyxcbiAgICAgICAgICAgICdyZWxvYWQnLFxuICAgICAgICAgICAgJ3NuYXBzaG90JyxcbiAgICAgICAgICAgICdvcGVuJyxcbiAgICAgICAgICAgICdzYXZlJyxcbiAgICAgICAgICAgICdjbG9zZScsXG4gICAgICAgICAgICAnYWRkJyxcbiAgICAgICAgICAgICdkdXBsaWNhdGUnLFxuICAgICAgICAgICAgJ3BhcmVudCcsXG4gICAgICAgICAgICAnZm9jdXMnLFxuICAgICAgICAgICAgJ2FsaWduJyxcbiAgICAgICAgICAgICdyZXN0b3JlJyxcbiAgICAgICAgICAgICdyZXNldCcsXG4gICAgICAgICAgICAnYXBwbHknXG4gICAgICAgIF07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYXNBY3Rpb25LZXl3b3JkKHRvb2xOYW1lOiBzdHJpbmcsIGtleXdvcmRzOiBzdHJpbmdbXSk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCB0b2tlbnMgPSB0b29sTmFtZS5zcGxpdCgnXycpLmZpbHRlcigodG9rZW4pID0+IHRva2VuICE9PSAnJyk7XG4gICAgICAgIHJldHVybiBrZXl3b3Jkcy5zb21lKChrZXl3b3JkKSA9PiB0b2tlbnMuaW5jbHVkZXMoa2V5d29yZCkpO1xuICAgIH1cbn1cbiJdfQ==